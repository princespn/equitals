<style type="text/css">
    .input-group {
    position: relative;
    display: flex!important;
    border-collapse: separate;
    width: 100%!important;
}
    .frame_block{
    box-shadow: 0px 2px 9px 0px #333;}
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] {
        float: left;
        /* min-width: 280px;
        max-width: 340px; */
        width: 35%;
        height: 560px;
        background: #25466a;
        color: #f5f5f5;
        position: relative;
    }
    #sidepanel[_ngcontent-c5] #profile[_ngcontent-c5] {
        width: 100%;
        margin: 25px auto;
        display: inline-block;
        padding: 0 20px;
    }
    #sidepanel[_ngcontent-c5] #profile[_ngcontent-c5] .wrap[_ngcontent-c5] {
        height: 60px;
        line-height: 60px;
        overflow: hidden;
        transition: height .3s ease;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #profile[_ngcontent-c5] .wrap[_ngcontent-c5] img.online[_ngcontent-c5] {
        border: 2px solid #2ecc71;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #profile[_ngcontent-c5] .wrap[_ngcontent-c5] p[_ngcontent-c5] {
        float: left;
        margin-left: 15px;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #search[_ngcontent-c5] {
        border-top: 1px solid #13212f;
        border-bottom: 1px solid #13212f;
        font-weight: 300;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #search[_ngcontent-c5] label[_ngcontent-c5] {
        position: absolute;
        margin: 10px 0 0 20px;
        color:#fff;
    }
    .fa {
        display: inline-block;
        font: normal normal normal 14px/1 FontAwesome;
        font-size: inherit;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
    .fa-search:before {
        content: "\F002";
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #search[_ngcontent-c5] input[_ngcontent-c5] {
        font-family: proxima-nova,Source Sans Pro,sans-serif;
        padding: 10px 0 10px 70px;
        width: calc(100% - 8px);
        border: none;
        background: #25466a;
        color: #f5f5f5;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] {
        height: calc(100% - 177px);
        overflow-y: auto;
        overflow-x: hidden;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] {
        list-style-type: none;
        padding-left: 0px;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] li.contact.active[_ngcontent-c5] {
        background: #32465a;
        border-right: 5px solid #435f7a;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] li.contact[_ngcontent-c5] .wrap[_ngcontent-c5] {
        width: 88%;
        margin: 0 auto;
        position: relative;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] li.contact[_ngcontent-c5] .wrap[_ngcontent-c5] span.online[_ngcontent-c5] {
        background: #2ecc71;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] li.contact[_ngcontent-c5] .wrap[_ngcontent-c5] span.online[_ngcontent-c5] {
        background: #2ecc71;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] li.contact[_ngcontent-c5] .wrap[_ngcontent-c5] img[_ngcontent-c5] {
        width: 40px;
        border-radius: 50%;
        float: left;
        margin-right: 10px;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] li.contact[_ngcontent-c5] .wrap[_ngcontent-c5] .meta[_ngcontent-c5] {
        padding: 5px 0 0 0;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] li.contact[_ngcontent-c5] .wrap[_ngcontent-c5] .meta[_ngcontent-c5] .name[_ngcontent-c5] {
        font-weight: 600;
    }
    a:not([href]):not([tabindex]), a:not([href]):not([tabindex]):focus, a:not([href]):not([tabindex]):hover {
        color: inherit;
        text-decoration: none;
    }

    #frame[_ngcontent-c5] .content[_ngcontent-c5] .contact-profile[_ngcontent-c5] {
        width: 100%;
        height: 60px;
        line-height: 60px;
        background: #25466a;
        box-shadow: 0px 2px 8px #333;
        display: inline-block;
        position: relative;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .contact-profile[_ngcontent-c5] img[_ngcontent-c5] {
        width: 40px;
        border-radius: 50%;
        float: left;
        margin: 9px 12px 0 9px;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .contact-profile[_ngcontent-c5] p[_ngcontent-c5] {
        float: left;
        color:#fff;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .messages[_ngcontent-c5] {
        height: auto;
        min-height: calc(100% - 118px);
        max-height: calc(100% - 118px);
        overflow-y: scroll;
        overflow-x: hidden;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .messages[_ngcontent-c5] ul[_ngcontent-c5] li[_ngcontent-c5] {
        display: inline-block;
        clear: both;
        float: left;
        margin: 5px 15px 5px 15px;
        width: calc(100% - 25px);
        font-size: .9em;
    }
    .badge-light {
        color: #111;
        background-color: #f8f9fa;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .message-input[_ngcontent-c5] {
        position: absolute;
        bottom: 0;
        width: 100%;
        z-index: 99;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .message-input[_ngcontent-c5] .wrap[_ngcontent-c5] {
        position: relative;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .message-input[_ngcontent-c5] .wrap[_ngcontent-c5] input[_ngcontent-c5] {
        font-family: proxima-nova,Source Sans Pro,sans-serif;
        float: left;
        border: none;
        width: calc(100% - 90px);
        padding: 14px 32px 14px 8px;
        font-size: 1.2em;
        color: #32465a;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .message-input[_ngcontent-c5] .wrap[_ngcontent-c5] button[_ngcontent-c5] {
        float: right;
        border: none;
        width: 50px;
        padding: 12px 0;
        cursor: pointer;
        background: #32465a;
        color: #f5f5f5;
    }

    #frame[_ngcontent-c5] .content[_ngcontent-c5] {
        width: calc(100% - 340px);
        float: left;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] {
        float: right;
        width: 65%;
        height: auto;
        overflow: hidden;
        position: relative;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .contact-profile[_ngcontent-c5] {
        width: 100%;
        height: 60px;
        line-height: 60px;
        background: #25466a;
    }
    #frame[_ngcontent-c5] #sidepanel[_ngcontent-c5] #contacts[_ngcontent-c5] ul[_ngcontent-c5] li.contact[_ngcontent-c5] {
        position: relative;
        padding: 10px 0 15px 0;
        font-size: .9em;
        cursor: pointer;
    }
    #msgContainer .msg_div{
        float: left;
        width: 100%;
        height: 500px;
        background-color: #E5E9E9;
    }
    #profile-img{
        width: 50px;
        border-radius: 50%;
        padding: 3px;
        border: 2px solid #e74c3c;
        height: auto;
        float: left;
        cursor: pointer;
        transition: border .3s ease;
    }
    .contact-profile {
        float: left;
    }
    .user_chat_image {
        width: 22px !important;
        border-radius: 50%!important;
        float: left;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .messages[_ngcontent-c5] ul[_ngcontent-c5] li.sent[_ngcontent-c5] p[_ngcontent-c5] {
        background: #435f7a!important;
        color: #f5f5f5!important;
    }
    #frame[_ngcontent-c5] .content[_ngcontent-c5] .messages[_ngcontent-c5] ul[_ngcontent-c5] li[_ngcontent-c5] p[_ngcontent-c5] {
        display: inline-block!important;
        padding: 10px 15px!important;
        border-radius: 20px!important;
        max-width: 205px!important;
        line-height: 130%!important;
    }
    @media screen and (min-width: 735px) {
        #frame[_ngcontent-c5] .content[_ngcontent-c5] .messages[_ngcontent-c5] ul[_ngcontent-c5] li[_ngcontent-c5] p[_ngcontent-c5] {
            max-width: 300px!important;
        }
    }
    .new_contacts{line-height: 60px;}
    .new_contacts .fa{font-size: 22px;}
    #frame .input_block{    
        box-shadow: 1px 2px 8px 0px #333;
        display: block;
        position: relative;
    }
    #frame .welcome_admin{    
        text-align: center;
        margin: 0;
        /*position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);*/
    }
    #frame .welcome_admin img{
        border-radius: 50%;
        width: 100px;
        border: 2px solid #25466a;
        padding: 2px;
    }
    #frame .welcome_admin h3{
        margin-bottom:30px;
    }
    #frame .admin_msg_block{height:100%;}
    #frame .date{    
        width: 100%;
        margin: 20px auto;
        z-index: 1;
        position: relative;
        text-align: center;
    }
    #frame .date:before{
        border-top: 1px solid #25466a;
        content: "";
        margin: 0 auto;
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        bottom: 0;
        width: 95%;
        z-index: -1;
    }
    #frame .date span{background: #d6dbe0;padding: 10px;}
</style>

<template>
    <div class="content">
        <div class="page-content-wrapper ">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12 frame_block">
                        <div _ngcontent-c5="" class="chat" id="frame">
                            <div _ngcontent-c5="" id="sidepanel">
                                <div _ngcontent-c5="" id="profile">
                                    <div _ngcontent-c5="" class="wrap pull-left">
                                        <img _ngcontent-c5="" alt="" class="online" id="profile-img" src="public/images/1.jpg">
                                        <p _ngcontent-c5="">Admin</p>
                                    </div>
                                    <a v-if="isChatContacts" class="new_contacts pull-right" @click="openAddressBook()"><i class="fa fa-address-book-o"></i></a>
                                    <a v-if="isNewContacts" class="new_contacts pull-right" @click="closeAddressBook()"><i class="fa fa-close"></i></a>
                                </div>
                                <div _ngcontent-c5="" id="search">
                                    <label _ngcontent-c5="" for="">
                                        <i _ngcontent-c5="" aria-hidden="true" class="fa fa-search"></i>
                                    </label>
                                    <input _ngcontent-c5="" v-model="search" id="search" placeholder="Search contacts..." type="text" class="ng-untouched ng-pristine ng-valid" v-on:keyup="search_user">
                                </div>
                                <div _ngcontent-c5="" id="contacts">
                                    <ul v-if="isChatContacts" _ngcontent-c5="" v-for="(supportchat,index) in supportchats" :key="index" @click="(supportchat.from_user_id == 1)?chatWindow(supportchat.touser,supportchat.touser_name,index):chatWindow(supportchat.fromuser,supportchat.fromuser_name,index)" v-bind:class="{active: isActive==index}">
                                        <li _ngcontent-c5="" class="contact ng-star-inserted">
                                            <div _ngcontent-c5="" class="wrap">
                                                <span _ngcontent-c5="" class="contact-status online"></span>
                                                <img _ngcontent-c5="" alt="" src="public/images/1.jpg">
                                                <div _ngcontent-c5="" class="meta">
                                                    <p _ngcontent-c5="" class="name">
                                                        {{(supportchat.from_user_id == 1)?(supportchat.touser_name+ "("+ supportchat.touser ):(supportchat.fromuser_name+ "("+ supportchat.fromuser )}}) 
                                                        <a _ngcontent-c5="" class="badge badge-pill badge-danger pull-right ng-star-inserted" v-if="supportchat.count!=0">{{ supportchat.count }} </a>
                                                    </p>           
                                                </div>
                                            </div>
                                        </li>                                        
                                    </ul>

                                    <ul v-if="isNewContacts" _ngcontent-c5="" v-for="(supportchat,index) in alluserlist" :key="index" @click="chatWindow(supportchat.user_id,supportchat.fullname,index)" v-bind:class="{active: isActive==index}">
                                        <li _ngcontent-c5="" class="contact ng-star-inserted">
                                            <div _ngcontent-c5="" class="wrap">
                                                <span _ngcontent-c5="" class="contact-status online"></span>
                                                <img _ngcontent-c5="" alt="" src="public/images/1.jpg">
                                                <div _ngcontent-c5="" class="meta">
                                                    <p _ngcontent-c5="" class="name">
                                                        {{supportchat.fullname}} ({{ supportchat.user_id }}) 
                                                    </p>           
                                                </div>
                                            </div>
                                        </li>                                        
                                    </ul>
                                </div>                                
                            </div>
                            <div _ngcontent-c5="" class="content" style="float:left !important;">
                                <div class="admin_msg_block" v-if="userchats.length!=0">
                                    <div _ngcontent-c5="" class="contact-profile">
                                        <img _ngcontent-c5="" alt="" src="public/images/1.jpg">
                                        <p _ngcontent-c5="" class="to_user_name">{{fromuser_name}} ({{fromuser}})</p>
                                    </div>
                                    <div _ngcontent-c5="" class="messages" id="msgContainer" style="clear: both;" v-chat-scroll="{always: false}">
                                        <div class="nano" style="height: 60vh">
                                            <div class="nano-content scroll-content">
                                                <div class="panel-body chat-body media-block" v-for="data in userchats" :key="data.id">
                                                    <div v-for="message in data" :key="message.id">
                                                        <div class="date" v-if="message.showtime"><span class="text-center">{{message.showtime}}</span></div>
                                                        <div v-for="msg in message.msgdata " :key="msg.id">
                                                            <div v-if="msg.left">
                                                                <div class="chat-user">
                                                                    <div class="media-body">
                                                                        <div>
                                                                            <div v-if="msg.left.attachment">
                                                                                <div v-for="file in msg.left.files" :key="file.id">
                                                                                    <a class="pointer" @click="showImage('public/uploads/support/'+file)"> <img :src="'public/uploads/support/'+file" class="w200"></a>
                                                                                </div>
                                                                               
                                                                                
                                                                            </div>
                                                                            <p v-if="msg.left.message">
                                                                                {{ msg.left.message }}
                                                                                 <!-- <br><small>{{msg.left.time}}</small> -->
                                                                                 </p>
                                                                                <!-- <br><p v-if="msg.left.translated_message">{{ msg.left.translated_message }}<small>{{msg.left.time}}</small></p> -->
                                                                             <br>
                                                                            <small>{{msg.left.time}}</small>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div v-if="msg.right">
                                                                <div class="chat-me">
                                                                    <div class="media-body">
                                                                        <div>
                                                                            <div class="clearfix" v-if="msg.right.attachment">
                                                                                <div v-for="file in msg.right.files" :key="file.id">
                                                                                     <a class="pointer" @click="showImage('public/uploads/support/'+file)"> <img :src="'public/uploads/support/'+file" class="w200 fr img-thumbnail"></a>
                                                                                      <!-- <small class="fr">{{msg.right.time}}</small> -->
                                                                                </div>
                                                                               
                                                                               
                                                                            </div>
                                                                             <br>
                                                                            <!-- <p v-if="msg.right.translated_message">
                                                                                {{ msg.right.translated_message }}<small>{{msg.right.time}}</small></p><br> -->
                                                                                <p v-if="msg.right.message" class="fr">{{ msg.right.message }} </p>
                                                                               <div> <small class="fr">{{msg.right.time}}</small></div>
                                                                        </div>                 
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>                                      
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pad-all input_block">
                                        <div v-bind:class="isUpload">
                                            <span v-for="(file, index) in files" :key="file.id">
                                                <img :src="file" class="w200" />
                                                <i class="fa fa-close pointer" @click="removeImage(index)"></i>
                                            </span>
                                        </div>
                                        <div class="input-group typ-msg">
                                            <input type="text" v-model="message" placeholder="Type your message" ref="input" class="form-control form-control-trans" @focus="closeEmoji" @keyup.enter="trigger">
                                            <span class="">
                                            <!-- <button class="btn  btn-icon " data-original-title="Add file" type="button"><i class="demo-psi-paperclip icon-lg"></i></button> -->
                                               <!--  <input type="file" class=" form-control" name="file" id="file" ref="file" accept="image/*" multiple @change="onFileChange"/> -->
                                               <!--  <button onclick="document.getElementById('file').click();" class="btn btn-icon" type="button"><i class="fa fa-paperclip icon-lg"></i></button> -->
                                            </span>
                                            <span class="">
                                                <button @click="showEmojiPicker" class="btn btn-icon" type="button"><i class="fa fa-smile-o"></i></button>
                                            </span>
                                            <Picker
                                              v-show="isEmojiPicker"
                                              @select="addEmoji"
                                              :style="{ position: 'absolute', bottom: '25px', right: '20px' }"
                                            />
                                            <span class="">
                                                <button @click="sendMessage()" class="btn btn-icon" data-original-title="Send" type="button"><i class="fa fa-paper-plane icon-lg"></i></button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="welcome_admin" v-if="userchats.length==0">
                                    <img src="public/images/1.jpg">
                                    <h3>Welcome Admin</h3>
                                    <button class="btn btn-primary" @click="openAddressBook()">Start conversation</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <vue-easy-lightbox
        :visible="visible"
        :imgs="imgs"
        :index="index"
        @hide="handleHide"
        ></vue-easy-lightbox>
    </div>
</template>

<script>
    import { apiAdminHost } from'./../../admin-config/config';
    import swal from 'sweetalert2';
    import DatePicker from 'vuejs-datepicker';
    import moment  from 'moment';
    import VueEasyLightbox from 'vue-easy-lightbox';
    import {Picker} from 'emoji-mart-vue';
    
    export default {
        components: {
            VueEasyLightbox,
            Picker,
          },
        data() {
            return { 
                alluserlist:[],               
                supportchats: [],
                message:'',
                userchats:[],
                msgdata:[],
                fromuser:'',
                fromuser_name:'',
                files:[],
                upload_files:[],
                gallery_files:[],
                scrolled:false,
                isActive:-1,
                search:'',
                isChatContacts:true,
                isNewContacts:false,
                imgs: '',  // Img Url , string or Array
                visible: false,
                index: 0 ,  // defaul
                isEmojiPicker: false,
                type:'text',
                typing:false,
                user:'',
                trans_word:''
                // userchats: {

                // }
            }
        }, 
        components: {
            DatePicker
        },       
        computed: {
            isUpload()
            {
                if(this.files.length!=0){
                    return 'show preview_file_block';
                }
                else{
                    return 'hide';
                }
            },
            isCompleteChat() {
                return this.message;      
            },
        },
        mounted() {
            this.getChatLists();
        },
        created(){
            Echo.channel('chat')
            .listen('MessageSent', (e) => {
                this.getChatLists();
                if(this.fromuser==e.user.user_id)
                {
                    this.chatWindow(this.fromuser,this.fromuser_name,this.isActive);
                }      
            });
            
        },
        methods: {
            trigger () {
                this.sendMessage();
            },
/*             translate(){
                axios.post('/translate',{word:this.message})
                .then(resp => {
                    if(resp.data.code === 200){
                        this.trans_word = resp.data.data.trans_word;
                    } else {
                        this.$toaster.error(resp.data.message);
                    }
                }).catch(err => {
                    this.$toaster.error(err);
                })
            }, */
            search_user(){
                if(this.isChatContacts)
                {
                    this.getChatLists();
                }
                else if(this.isNewContacts)
                {
                    this.openAddressBook();
                }    
            },
            onFileChange(e) {
                var files = e.target.files || e.dataTransfer.files;
                var i=0;
                if (!files.length)
                    return;
                for(i=0;i<files.length;i++)
                {
                    this.createImage(files[i]);
                }       
            },
            createImage(create_file) {
                let reader = new FileReader();
                let vm = this;
                reader.onload = (e) => {
                    vm.files.push(e.target.result);
                    // vm.file = e.target.result;
                };
                reader.readAsDataURL(create_file);
            },
            removeImage(key) {
                this.files.splice(key, 1);
            },
            dateFormat(date) {
                return moment(date).format('DD-MM-YYYY');
            },
            getChatLists(){
                axios.post('/chat_list',{search:this.search})
                .then(resp => {
                    if(resp.data.code === 200){
                        this.supportchats = resp.data.data;
                        var i=0;
                        var $this=this;
                        this.supportchats.filter(function(elem){
                            if(elem.fromuser == $this.fromuser){
                                $this.isActive=i;
                            }
                            i++;
                        });
                        // alert(this.isActive);
                    } else {
                        this.supportchats = [];
                        // this.$toaster.error(resp.data.message);
                    }
                }).catch(err => {
                    this.$toaster.error(err);
                })
            },
            chatWindow(fromuser,fromuser_name,key) {
                // $('.to_user_name').text(fromuser);
                this.fromuser = fromuser;
                this.fromuser_name = fromuser_name;
                this.isActive = key;
                axios.post('fetch_message',{
                    to_user : fromuser
                }).then(response => {
                    this.userchats = response.data.data;
                    this.imgs=response.data.data.files;
                    if(this.isChatContacts)
                    {
                        this.getChatLists();
                    }
                    else if(this.isNewContacts)
                    {
                        this.openAddressBook();
                    }  
                    //alert(this.userchats);
                }).catch(error => {

                });               
            },
            sendMessage() {
                var to_user_name = this.fromuser;
                let formData = new FormData();
               /* let uploadedFiles = this.$refs.file.files;
                for(let i=0;i<this.files.length;i++)
                {
                    this.upload_files.push(uploadedFiles[i]);
                    formData.append('files[]', this.upload_files[i]);
                    this.type='file';
                }*/
                formData.append('to_user', to_user_name);
                formData.append('message', this.message);
                formData.append('translated_message', this.trans_word);
                formData.append('type', this.type);
                axios.post('send-message', formData,
                {
                    headers: {
                        'Content-Type': 'multipart/form-data'
                    }
                })
                .then(response => {
                    if(response.data.code == 200){
                        this.$toaster.success(response.data.message);
                        this.message='';
                        this.trans_word='';
                        this.files=[];
                        this.upload_files=[]; 
                        this.chatWindow(to_user_name,this.fromuser_name,this.isActive);
                        this.updateScroll();    
                    } else {
                       this.$toaster.error(response.data.message);
                    }
                })
            },
            updateScroll(){
                if(!this.scrolled){
                    var nanocontent = this.$el.querySelector("#msgContainer");
                    var height=nanocontent.scrollHeight;
                    nanocontent.scrollTop=height+100; 
                }
                this.onScrollUpdate();
            },
            onScrollUpdate(){
                $("#msgContainer").on('scroll', function(){
                    this.scrolled=true;
                    
                });
            },
            openAddressBook(){
                if(this.isChatContacts)
                {
                    this.search='';
                    this.isActive=-1;
                } 
                this.isChatContacts=false;
                this.isNewContacts=true;
                
                axios.post('/alluser_list',{search:this.search})
                .then(resp => {
                    if(resp.data.code === 200){
                        this.alluserlist = resp.data.data;
                    } else {
                        this.alluserlist = [];
                        // this.$toaster.error(resp.data.message);
                    }
                }).catch(err => {
                    this.$toaster.error(err);
                })
            },
            closeAddressBook(){
                this.isChatContacts=true;
                this.isNewContacts=false;
                this.search='';
                this.isActive=-1;
                this.getChatLists();
            },
            showImage(image) {
                var i=this.imgs.indexOf(image);
                this.index = i ;
                this.show();
            },
            show() {
              this.visible = true;
            },
            handleHide() {
              this.visible = false;
            },
            showEmojiPicker(){
                this.isEmojiPicker=!(this.isEmojiPicker);
            },
            addEmoji (emoji) {
                this.message=this.message+emoji.native;
            },
            closeEmoji(){
                this.isEmojiPicker=false;
            }      
        }
    }
</script>